---
title: "Final Report: Your Title Here"
author: "Don Francisco"
date: "December 5, 2018"
output:
    github_document: default
bibliography: references.bib
csl: bioinformatics.csl
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

Add about 2-3 pages here. Across the whole manuscript, you should cite at least 20 peer reviewed articles.

# Methods

## Study design

Add about half a page here. In this section instead of first person (I/we), use the authors of the paper you selected, since you'll just be describing what they did, based on the methods in their paper.

## Sample origin and sequencing

Add about half a page here. In this section instead of first person (I/we), use the authors of the paper you selected, since you'll just be describing what they did, based on the methods in their paper.

## Computational

These are the methods you used to do your bioinformatic analyses analyses. Should probably be between 0.5 and 1 pages. At a very minimum should include citations for DADA2 and phyloseq if you are doing an amplicon study, or other citations as appropriate.

# Results

## Subsections are ok in the results section too

```{r your-code-here}
# Add code chunks as needed for your analyses
# For most analyses, I would recommend splitting the
# intensive computational part into a seperate R script file
# and then just load your libraries and the data object here
# using the `load()` function. Ask me for clarification if this is
# unclear.
```
                    
```{r}
melted_obj <- psmelt(phyloseq_obj)
```


```{r}
top_15 <- melted_obj %>%
  group_by(sfffile_id_R1, Genus) %>%
  arrange(desc(Abundance)) %>%
  head(50)


top_15 %>%
  kable()



  ggplot(aes(x = bmi,
             y = Abundance,
             color = disease_stat)) +
  geom_point()

```









```{r}
melted_obj %>%
  ggplot(aes(x = disease_stat,
             y = Abundance,
             fill = Phylum,
             color = Phylum)) +
  geom_col() +
  facet_grid(~ FOBT.result)
```
Figure 1. In different types of tissue samples, they have very similar composition of microbia communities, but there are differences in the Abunance of different phlyum. 


```{r}
melted_obj %>%
  filter(Phylum %in% c("Proteobacteria", "Firmicutes", "Verrucomicrobia", "Bacteroideetes")) %>%
  filter(Class != "NA") %>%
  ggplot(aes(x = Class,
             y = Abundance,
             color = FOBT.result,
             fill = FOBT.result)) +
  geom_col(position = "dodge") +
  facet_grid(~ disease_stat) +
  theme(axis.text.x = element_text(angle = 90,
                                     hjust = 1))
```
Figure 2. Picked out top four most common Phylum and examine their corrolation between Class and FOBT results. Blood clots were only found in cancer tissues, and cancer tissue has a different micorbia community distribution than the normal tissue. 

```{r}
melted_obj %>%
  filter(Class %in% c("Gammaproteobacteria", "Bacilli", "Clostridia", "Negativicutes")) %>%
  filter(FOBT.result == "positive") %>%
  ggplot(aes(x = disease_stat,
             y = Abundance,
             fill = Class)) +
  geom_col() +
  facet_grid(~ sex)
```

Figure 3. Filtered out the Class that in significantly more abundant in cancer community Gammaproteobacteria and examine in the tissue that has blood clot, how the mricobia community different in gender

```{r}
melted_obj %>%
  filter(Class %in% c("Clostridia")) %>%
  filter(FOBT.result == "positive") %>%
  ggplot(aes(x = age,
             y = Abundance,
             color = Family)) +
  geom_jitter() +
  facet_grid(~ disease_stat)
```




```{r}
melted_obj %>%
  filter(Order %in% c("Ruminococcaceae", "Lachnospiraceae")) %>%
  ggplot(aes(x = age,
             y = Abundance,
             fill = Genus)) +
  geom_col(position = "dodge")
```

```{r}
melted_obj %>%
  filter(Genus == "Escherichia/Shigella") %>%
  ggplot(aes(x = Abundance,
             y = bmi,
             color = FOBT.result )) +
  geom_point()
```
 
```{r}
melted_obj %>%
  filter(Genus == "Escherichia/Shigella") %>%
  filter(disease_stat != "normal") %>%
  ggplot(aes(x = bmi,
             y = age,
             color = FOBT.result )) +
  geom_point() +
  geom_smooth()
```


In addition to a minimum of 5-8 figures/tables (and associated captions), you should include sufficient text in this section to describe what your findings were. Remember that in the results section you just describe what you found, but you don't interpret it - that happens in the discussion. 2-3 pages.

# Discussion

Add around 3-4 pages interpreting your results and considering future directions one might take in analyzing these data.

# Sources Cited
