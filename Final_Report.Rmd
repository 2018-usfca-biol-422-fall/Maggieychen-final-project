---
title: "Final Report: Your Title Here"
author: "Don Francisco"
date: "December 5, 2018"
output:
    github_document: default
bibliography: references.bib
csl: bioinformatics.csl
---

```{r setup, include = FALSE}
# Not show up this code and the outcome
# echo = FALSE hide all the codes for the graphs
knitr::opts_chunk$set(echo = FALSE)
```

# Introduction

Add about 2-3 pages here. Across the whole manuscript, you should cite at least 20 peer reviewed articles.

Microbial community has constantly interact with human communities and there are both benefits and harms can be done to human health by different bacteria. For instance, microbial community in human's gut is a typical example of how the human can benefit from bacteria. The microbial community in human's gut support metabolic activities, which will help the provide energy and provide nutrients for human's body. The microbial community in the gut also help provide immune protection against alien microbes [@mcmurdie2013]. However, microbial community can also be related to colon cancer. Worldwide, coloretal cancer has accounted for over a half million death annually, which is the third most commonly diagnosed malignancy [@parkin2005global]. There two major stages of correctional cancer development, firstly, it start with the precancerous adenomatous polyps in the colon, which is also known as the adenoma. The second stage is the progression into invasive and metastatic cancerous tumor, which is also called carcinoma [@levin2008screening]. The development of colorectal adenocarcinoma can be caused by the sequenctial or epigenetic mutation in the epithlial cells in the gastronintestinal trait. The mutation modifies the normal epithlial cells into hyperperliferative mucosa, which gives rise to begin adenoma [@pancione2012genetic]. The normal gastonintestinal epithelium differentiate into several epithelial colon lineage including Panteh, goblet, and endocrine cells. They have the function of secret mucosa to lubercate the colon, and provide ptotection and anchor point for bacteria [@kosinski2007gene]. Thus, if the cancer causing mutation, alternated the function of colon  epithelial cell, there is a chance of cahnging the microbial community in the colon. Therefore, the abundance and composition of gastrointestinal mirobal coomunity may serve as an indication of cancer development. Due to the early diagnosis, the colorectal cancer have a steady decrease of death rate in the United States.      

For this paper, my primary question of interest is that what are the microbiomes that present differently in adenoma, carcinoma, and normal tissues. Also, what are their functions or relationship to the colorectal cancer. Then examine whether there is a corrolation between bacteria species and the personal variables like BMI, geographical locations and medication. As an result, for adenoma, carcinoma, and normal tissues, there is a simmilar microbial community composition, but there is a different the abundance of each bacteria species. Also, bacterias can function in both directions, aid in cancer progession or help slow down the cancer progession. Lastly, geographical regions and medication will also impact and shape the microbial community in individuals, which can function as an possible prediction and guidence for colorectal cancer treatments. 

Eventhough colon has been the part in human body that has most bacteria invloved, but the knowledge of investigating the relationship between cancer and mirobial communities in human bodies can be applied to other types of cancer, both in treatment and preventions. 

# Methods

## Study design

Add about half a page here. In this section instead of first person (I/we), use the authors of the paper you selected, since you'll just be describing what they did, based on the methods in their paper.

Zacular et al, examined 90

## Sample origin and sequencing

Add about half a page here. In this section instead of first person (I/we), use the authors of the paper you selected, since you'll just be describing what they did, based on the methods in their paper.

Approved by the University of Michigan Insititional Review Board and all subjects provided informed consent. Zacular et al. took sample from patients, that were 18 years of age or older, and who could tolerate 58ml of blood removal at two time points, willing to compkete an gFOBT kit, able to provide informed consent, also who had colonoscopy and histologically confirmed colonic disease status. Zacular et al, excluded pateiens who is known to have HIV, chronic vial hepatitis, HNPCC, FAP, inflammatory bowel disease. Or any surgery radiation and chemotherapy for their current colorectal cancer or colonic adenoma. Fecal samples and the colonoscopies were collected and performed respectivly from four subjects of locations including, Toronto Canada, Boston Massachusrtts, USA; Houston Texas, USA; and Ann Arbor Michigan, USA. The colonoscopies were followed by endoscopic examination, and patients who have no colonic abnormalities weer designated as healthy. For examinations that revealed the presence of lesions resulted in a biopsy and subsquence diagnosis of adenoma or carcinoma. All the samples collected from participants were collected following the usual dietary and medication restriction for 24 hours, as a whole evacuated stoll in a hat with no preservatives. The gFOBT 6-Panel kit (Sensa HemocultII, Beckman-coulter) was prepared by patients immediately after the previous collection, from different areas of the stool.  

## Computational

These are the methods you used to do your bioinformatic analyses analyses. Should probably be between 0.5 and 1 pages. At a very minimum should include citations for DADA2 and phyloseq if you are doing an amplicon study, or other citations as appropriate.


I used DADA to analyze and clean the data, then phyloseq and ggplot to visualize the results. Firstly, I ran a quality control on all twenty of the sample data, which generated a quality profile on each of the samples. Then according to the sequence quality, I trimmed the data if they have more than three expected error, and has a quality lower than two. As a quality control, I created a table to compare the read counts before and after the trim to ensure I did not trim off too many sequences. After the trim, I build an error model for each sample to assess the probability of an unmatched base is an error or not, and a plot to check whether the error model matches the data. After it, I also deleted the duplicated sequences. Then as an essential step, I DADA to process the sequence data. DADA is an analysis include the error model and evaluates whether the unique sequence found is true or false. DADA eliminates the false positive results to provide the real variants and limit spurious sequence, to provide a high-resolution amplicon data [@callahan2016].

 Then I listed the output of the DADA analysis on a table according to the variety of length. As well as a histogram to indicate the distribution of the sequence that is trimmed and denoised, to ensure that all the sequences are in acceptable length and quality. Using this output, I also removed all the chimeras, which is the cDNA sequence that generated from two transcripts that is caused by polymerase stuck and ump to another similar sequence. Using the sequence data, I assigned the taxonomy according to the supplied training set. I also created a phylogeny tree using the trimmed and denoised sequence data. Using the dada2 output, I charted a data set, which contains the metadata for each sample, Phylogeny, and taxonomy for each sequence. Then to enable the ggplot function, I combined the taxa and metadata into one table. 

# Results

Firstly I was intrerested in how is the distribution of Phylum in different cancer progrssion stages, which includes normal, adenoma, and carcinma. I found that in different types of fecal samples, they had very similar composition of microbia communities, but there are differences in the abundancy of different phlyums. The distribution pattern in three kinds of tisssue samples are very different. The Bacteroidetes abundance decreased in the order of normal samples as the highest abundance, then carcinoma, adenoma samples. Fusobacteria is signficantly more abundant in carcinoma samples. Proteibacteria is more abundant in adenoma and carcinoma samples than the normal samples. 
## Subsections are ok in the results section too

```{r load-RData-knit}
# Add code chunks as needed for your analyses
# For most analyses, I would recommend splitting the
# intensive computational part into a seperate R script file
# and then just load your libraries and the data object here
# using the `load()` function. Ask me for clarification if this is
# unclear.
load("Dataset.RData")
```
                    


```{r load-packages-and-data, include = FALSE}
# load general-use packages
library("dplyr")
library("tidyr")
library("knitr")
library("ggplot2")
library("tibble")

# this package allows for the easy inclusion of literature citations in our Rmd
# more info here: https://github.com/crsh/citr
# and here:
# http://rmarkdown.rstudio.com/authoring_bibliographies_and_citations.html
library("citr")

# These are the primary packages well use to clean and analyze the data
# this package needs to be installed from bioconductor -- it's not on CRAN
# see info here: https://benjjneb.github.io/dada2/dada-installation.html
library("dada2")

# This to export a fasta of our final denoised sequence variants
library("seqinr")

# To install this you have to install from GitHub
# See more info here: https://github.com/leffj/mctoolsr
# run this -- install.packages("devtools")
# and then this -- devtools::install_github("leffj/mctoolsr")
library("mctoolsr")

# And this to visualize our results
# it also needs to be installed from bioconductor
library("phyloseq")

```


```{r melt-tables}
melted_obj <- psmelt(phyloseq_obj)
```



```{r Phylum-disease-corrolation-barplot}
# To examine the difference of microbia composition
# under the context of Phylum, in different tissue
# types and FOBT results
melted_obj %>%
  filter(Phylum != "NA") %>%
  ggplot(aes(x = Phylum,
             y = Abundance,
             fill = disease_stat,
             color = disease_stat)) +
  geom_col(position = "dodge") +
  ggtitle("Phylum and Disease State Corrolation") +
  xlab("Disease State") +
  ylab("Abundance") +
  theme(axis.text.x = element_text(angle = 90,
                                   hjust = 1))
```

Figure 1. In different types of fecal samples, they have very similar composition of microbia communities, but there are differences in the abundancy of different phlyum. The distribution pattern in three kinds of tisssue samples are very different. The Bacteroidetes abundance decreased in the order normal samples has the highest abundance, then carcinoma and then adenoma samples. Euryarchaeota is in the opposit trending than the Bacteroidets, the abundance increase in the order og normal, carcinoma, and adenoma. Fusobacteria is signficantly more abundant in carcinoma samples. Proteibacteria is more abundant in adenoma and carcinoma samples than the normal samples. 


```{r top-Phylum-into-class-and-FOBT-boxplot}
# Take the most commonly found Phylums from previous figure
# examine the class under them, and in different tissue types
# and FOBT results

melted_obj %>%
  filter(Phylum %in% c("Proteobacteria", "Fusobacteria",
                       "Bacteroidetes", "Firmicutes")) %>%
  filter(Class != "NA") %>% #To exclude the NA samples
  filter(disease_stat != "normal") %>%
  ggplot(aes(x = Class,
             y = Abundance,
             color = FOBT.result)) +
  geom_boxplot(position = "dodge", width = 1) +
  ggtitle("FOTB Differentiate the Class Abundance in Variant Tissue Types ") +
  xlab("Class") +
  ylab("Abundance") +
  facet_grid(disease_stat ~ Phylum, scales = "free_x") +
  scale_y_log10() +
  theme(axis.text.x = element_text(angle = 40,
                                     hjust = 1))
```

Figure 2. Picked out four Phylum that has a diffrent abundance in normal, adenoma, and carcinoma samples. Then examined their corrolation between Class and FOBT results. Blood clots were only found in adenoma and carcinoma samples. There are several Class has significant high abundance in the FOBT positive samples. The boxplot help to identify the outliers and the mean vaule of the abundance. As a results, Bacterioidia has the some abundance in both FOBT positive and negative samples from adenoma, and carcinoma. In both adenoma and carcinoma samples, the FOBT sample had more abundant Fusobacteriia than FOBT negative samples. The Methanobacteria had a high average abundance in FOBT positive carcinoma tissue, then FOBT negative. In contrast, Methanobacteria had a relativly close average abundance between FOBT positive and negative adenoma samples.

```{r class-tissue-sex-boxplot}
# Take the Classes that are highly found in adenoma and carcinoma tissue
# which are FOBT positive. Examine how aundance different in different genders
melted_obj %>%
  filter(Class %in% c("Gammaproteobacteria", "Clostridia",
                      "Fusobacteriia", "Negativicutes")) %>%
  filter(FOBT.result == "positive") %>%
  ggplot(aes(x = disease_stat,
             y = Abundance,
             color = sex)) +
  geom_boxplot(position = "dodge") +
  ggtitle("Top Four Class in FOBT Positive Tissue Different by Gender") +
  xlab("Disease State") +
  ylab("Abundance") +
  scale_y_log10() +
  facet_grid(~ Class) +
  theme(axis.text.x = element_text(angle = 40,
                                     hjust = 1))
```

Figure 3. Filtered out the Class that has a significant difference between samples from differnet cancer progression stages and FOBT results. Thus, to futher analyze the corrolation between microbiome community and the gender. I filtered out the samples that are FOBT positive and catagorized into adenoma and carcinoma samples, colored the gender of the patients. For Fusobacteriia, there were mostly male samples only. Fusobacteria also had high abundance in carcinoma tissues, and lower in adenoma samples. For Gammaproteobacteria, in both adenoma and carcinoma samples, they had relativly simmilar abundance in both male and female samples. 



```{r Clostridia-Bacteroidia-sex-Family-barplot}
# For tissues that has blood clot in,
# what are the Family found under Class Clostridia and Bacteroidia
# and their relationships with gender and cancer types
# anaerosporobacter blautia coprococcus Ruminococcus2 Lactonifactor

melted_obj %>%
  filter(Class %in% c("Clostridia")) %>%
  filter(Family %in% c("Lachnospiraceae")) %>%
  filter(Genus %in% c("Lactonifactor", "Ruminococcus2", "Anaerosporobacter")) %>%
  ggplot(aes(x = Genus,
             y = Abundance,
             color = sex)) +
  geom_boxplot(position = "dodge") +
  facet_grid(disease_stat ~ FOBT.result, scales = "free_x") +
  ggtitle("Family Variation in Disease and Gender") +
  xlab("Disease State") +
  ylab("Abundance") +
  scale_y_log10() +
  theme(axis.text.x = element_text(angle = 90,
                                     hjust = 1))
```
Figure 4. In both male and female, FOBT positive adenoma and carcinoma samples, there are several bacteria Family is commonly found. In addition to those male has a more diverse microbial community and higher abundance. 




```{r Oscillibacter-FOBTneg-loc-barplot}
# From the FOBT negative tissues, how Oscillibacter is 
# distributed along with different bmi and location

melted_obj %>%
  filter(Genus %in% c("Ruminococcus")) %>%
  filter(FOBT.result == "negative") %>%
  group_by(geo_loc_name, disease_stat) %>%
  summarize(sum_abund = sum(Abundance)) %>%
  filter(sum_abund > 0) %>%
  ggplot(aes(x = disease_stat,
             y = sum_abund,
             color = geo_loc_name,
             fill = geo_loc_name)) +
  geom_col(position = position_dodge()) +
  ggtitle("Genus Oscillibacter Distribution in Geographical Locations") +
  xlab("Location") +
  ylab("Sum of Read Abundance")
```
Figure 5. In Genus Oscillibacter, FOBT negative tissue. This Genus has higher abundance in FOBT negative tissues, which is not an induction bacteria for the blood clots. Examine how different tissue type and bmi is correlated to the location regions. For all the adenoma are from Toronto, carcinoma samples are mostly from Boston and Houston. For normal healthy samples are more diverse. 


```{r Oscillibacter-FOBTneg-non-normal-Medication}
# Under the Genus *Oscillibacter*, in the FOBT negative and non-normal tissue
# examine how the medication will impact the abundancy
melted_obj %>%
  filter(Genus %in% c("Ruminococcus")) %>%
  filter(FOBT.result == "negative") %>%
  filter(disease_stat != "normal") %>%
  filter(Medications != "unknown") %>%
  filter(grepl(Medications, pattern = "lipitor")) %>%
  ggplot(aes(x = Medications,
             y = Abundance,
             color = disease_stat)) +
  geom_boxplot(width = 0.3, position = position_dodge()) +
  ggtitle(" Genus Oscillibacter Distribution Under Different Treatments") +
  xlab("Medication Type") +
  ylab("Abundance") +
  scale_y_log10() +
  facet_wrap(~ disease_stat, scales = "free_x") +
  theme(axis.text.x = element_text(angle = 90,
                                     hjust = 0.1))
```

Figure 6. To further investigate how *Oscillibacter* is impacted by the medication. For no treatment in the carcinoma, there is high abundance, the drug treatment will decrees the abundance of *Oscillibacter*, which might consider to be the negative effects of te drug treatment. For medications there are a lot of drugs been used to treat high cholesterol levels. 

In addition to a minimum of 5-8 figures/tables (and associated captions), you should include sufficient text in this section to describe what your findings were. Remember that in the results section you just describe what you found, but you don't interpret it - that happens in the discussion. 2-3 pages.

# Discussion

Add around 3-4 pages interpreting your results and considering future directions one might take in analyzing these data.

# Sources Cited
